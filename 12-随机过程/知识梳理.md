# 随机过程 知识点梳理

## 随机过程概述
+ 随机过程的**定义**：
	- 通俗定义：对随时间而变的随机现象的数学描述
	- 严格定义：一组依赖于参数t的随机变量{X(t),t∈T}。T称为参数集；参数t又称为指标，用于标识这些随机变量，通常具有时间的含义
		* X(t)，t∈T的可能取值的全体称为状态空间
	- 离散随机过程 & 连续随机过程
+ 随机过程的**二元函数观**：
	- 不仅依赖于时间，还依赖于样本空间中的样本点
	- 时间固定时，对应一元随机变量
	- 样本点固定时，对应随机过程的一条样本轨道
 + 随机过程的**四种类型**：
 	- 离散时间离散状态：伯努利过程
 	- 离散时间连续状态：自回归过程
 	- 连续时间离散状态：泊松过程
 	- 连续时间连续状态：随机相位正弦波
+ 随机过程的**分布**描述：
	- 联合分布的全体称为随机过程的**有限维分布族**
	- 独立随机过程：选择不同时刻，对应的诸变量统计独立
	- 随机等价→→有限维分布族完全相同(反之不一定成立)
+ 随机过程的**数字特征**：
	- 均值函数
	- 方差函数(二阶中心矩)
	- 自相关函数
	- 自协方差函数
+ 宽平稳 & 严平稳
	- 严平稳：有限维分布族具有时移不变性
	- 宽平稳：均值函数与t无关，相关函数只与时间差有关
+ 复随机过程：一组依赖于参数t的**复随机变量**
+ 多个随机过程：
	- 联合分布函数：
		* 分布函数可分解，则称两个随机过程不相关
	- 互相关函数：二阶混合原点矩
	- 互协方差函数：二阶混合中心矩

* * *

## 离散时间马尔可夫过程

#### 1. 马尔可夫性及马氏链
+ 马尔可夫性：
	- 已知当前时刻和过去历史，未来的状态只依赖于当前状态而与过去无关(无后效性)
	- 满足该含义的随机过程是马尔可夫过程，具有马尔可夫性
+ 马氏链：
	- 连续时间马氏链、离散时间马氏链
	- 举例：
		* 无限制的一维随机游动
		* 两端是吸收壁的随机游动
		* Google PageRank
+ 独立增量过程：
	- 增量相互之间是统计独立的，则是独立增量过程
	- 独立增量过程一定是马尔可夫过程
+ 转移概率：马氏链从一个状态到另一状态的概率
+ 齐次马氏链：
	- 一步转移概率与时刻无关(k步转移概率与发生时刻无关，只与时间间隔k有关)
	- 对于齐次马氏链，初始分布和一步转移概率可以完全确定任意时刻马氏链的状态分布

#### 2. Markov链状态的性质分类

+ 可达/不可达：
	- i能到达j，存在n使得i到j的n步转移概率大于0
	- 可达具有传递性
+ 相通：
	- i可达j，j可达i，则状态i和j相通
	- 相通具有：对称性、传递性和自反性，既具有等价关系
	- 因而根据相通可以将状态空间分为若干**互通等价类**
+ 等价类：
	- 等价类中很多性质相同，可以拓展为类性质
	- 相通等价类性质：
		* 不同等价类互不相交
		* 常返等价类是闭集
		* 零常返等价类有无穷个状态
		* 非常返等价类如果是闭集，则含有无穷个状态
+ 闭集：
	- 不能从集合B中到达S\B的部分，则为闭集('进得去，出不来')
	- 闭集只有1个状态，则该状态为**吸收态**
	- 整个状态空间S是最大的闭集，吸收态是最小的闭集
+ 可约/不可约：
	- 所有状态都是相同的闭集，成为不可约集
	- S不存在是闭集的真子集，则S是不可约的
+ 周期性：针对状态而言
	- 从状态i出发不可能再回到i，则i的周期为正无穷
	- 从状态i出发只能在d的整数倍步之后回到i，则i的周期为d
	- i的周期为1→i是非周期的
	- 证明周期性是类性质C-K(不等式)
+ 常返性：
	- 基本概念：
		* 首达时间：从状态i首次到达状态j的时间
		* 首达概率：系统从状态i出发，经过n步首次到达状态j的概率
		* 到达概率：从状态i出发，迟早到达状态j的概率
		* 返回概率：从状态i出发，迟早返回状态i的概率
		* 平均转移时间：从状态i出发，首次转移到状态j的平均转移时间
	- 若干性质：
		* i到j的到达概率 ≥ i到j的n步转移概率 ≥ i到j的n步首达概率
		* i到j的到达概率大于0，则i可达j
	- 常返性：
		* 若状态i的返回概率为1，则i是常返态
		* 若状态i的返回概率小于1，则i是非常返态(暂态、滑过态)
	- 正常返与零常返：
		* 若状态i的平均返回时间有限，则状态i是正常返的
		* 若状态i的平均返回时间无穷，则状态i是零常返的
	- 常返性的判别：
		* 从状态i到状态i的n步转移概率的无穷级数和是有限值(无穷值) ←→ 状态i是非常返态(常返态)
		* j是**非常返态或者零常返态**，则对于任意状态i，i到j的n步转移概率在n趋于无穷时为0
	- **重要结论**
		* 有限状态马氏链至少存在一个常返态(事实上至少存在一个正常返态)
		* 状态有限的不可约的马氏链，所有状态都是常返态(吸收态一定是常返态)，事实上所有状态都是正常返态
		* 弱遍历性定理
		* 相通的两个状态，必定同为正常返、零常返或同为非常返
	- 举例：
		* 两端吸收壁的随机游动：两端是吸收态(常返态)，中间状态都是暂态
		* 一端吸收壁的随机游动：p=1/2时是常返态，p≠1/2时是非常返态
		* 一维无限制随机游动：零常返
+ 小结：
	- 以上性质中，属于类性质的有：
		* 相通关系
		* 不可约
		* 周期性
		* 常返性

#### 3. 转移概率的极限行为
+ 转移概率的极限
	- 正常返的链，n步转移概率的极限仍然可能不存在
	- 对于常返的非周期状态j，n步返回概率极限存在，等于平均返回时间的倒数
	- 对于常返的周期状态j(周期为d)，n步返回概率极限存在，等于**周期/平均返回时间**
	- 遍历核心定理
	- 遍历态：状态i是正常返而且非周期
	- 对于遍历的不可约马氏链，状态i到j的n步转移概率极限是独立于i、与j有关的值
	- 只有正常返状态，转移概率极限才不存在或不为0
+ 状态空间的分解：
	- 大集合：全体非常返态，闭集或开集不定
	- 其他小集合：常返态闭集

#### 4. 马氏链的平稳分布
+ 若马氏链的初始分布是平稳分布，则任意时刻的分布是平稳分布，马氏链的**严平稳的**
+ 转移极限概率只与到达状态有关，与出发状态无关
+ 平衡方程：π=πP
	- 平衡方程有解不等价于转移概率极限存在
+ 不可约正常返马氏链的平稳分布：存在唯一平稳分布
	- 证明：C-K方程 + 控制收敛定理 + 核心遍历定理
+ 平稳分布数目的决定因素：
	- 不存在平稳分布：正常返状态集是空集
	- 唯一平稳分布：只有一个正常返的不可约闭集
	- 无穷多平稳分布：至少存在两个以上的正常返不可约闭集
+ 状态有限的马氏链必有平稳分布
+ 常返性判据：
	- 对于不可约马氏链，正常返 ←→ 有平稳分布
	- 非周期的不可约链是正常返的 ←→ 存在平稳分布，且此时平稳分布就是极限分布

#### 5. 反向马氏链和可逆马氏链
+ 对于齐次马氏链，其反向马氏链不一定是齐次的
+ 齐次马氏链存在平稳分布，当马氏链的初始分布为平稳分布时，其反向马氏链也是齐次的
+ 可逆马氏链：
	- 细致平衡方程
	- 满足细致平衡方程的初始分布π，必定是平稳分布，所以其反向马氏链也是齐次的

#### 6. 蒙特卡洛方法：
+ 定义：
	- 通过计算机模拟概率过程，实现多次模拟实验并统计计算结果，从而求得所求问题的近似结果
+ 如何按照某个确定分布生成大量的随机样本？
	- 假设需要从分布p(x)中获取大量样本，MCMC方法的基本想法是构造一个遍历马氏链，使得其平稳分布就是p(x)
+ 蒙特卡洛中的核心算法之一：
	- Metropolis Hastings算法

* * *

## 二阶矩过程-时域分析

#### 7. 二阶矩过程 & 宽平稳随机过程

+ 均值和方差都存在的随机过程
+ 二阶矩过程的自协方差函数和自相关函数总是存在
+ 宽平稳随机过程：
	- 定义：均值为常数，自协方差函数只有时间差有关
	- 宽平稳过程不一定是严平稳过程
	- 严平稳过程不一定是宽平稳过程
		* 严平稳且二阶矩存在，则为宽平稳
	- 性质：
		* 自相关函数零点值大于等于均值的平方
		* 自相关函数零点值是自相关函数绝对值函数的最大值
		* 自相关函数是一元非负定函数

#### 8. 随机过程的均方微积分
+ 均方极限的性质：
	- 唯一性
	- 线性
	- Lipchitz性：函数极限
+ 均方连续：
	- 二阶矩过程三个等价的命题
		* 自相关函数R(t,s)在(t,t)上均方连续
		* 随机过程Z(t)在R上均方连续
		* 自相关函数R(t,s)在R×R上连续
	- 特别地，对于宽平稳过程
		* 自相关函数在τ=0处连续
		* 宽平稳过程X(t)在R上均方连续
		* 自相关函数在R上连续
+ 均方导数：
	- 均方可导的充要条件是自相关函数二次广义可微
	- 随机过程在t0处可导等价于二次偏导在(t0,t0)处存在且连续
	- 若实宽平稳随机过程均方可导，则自相关函数一阶导为0
+ 均方积分：
	- X(t)的均方积分在对应区间上均方连续，而且均方可导

#### 9. 联合平稳
+ 若两个平稳随机过程的互相关函数仅是时间差的函数，则两个随机过程是联合平稳的随机过程
+ 对于宽平稳过程，通过线性时不变系统LTI后，输入输出两个随机过程是联合宽平稳的随机过程

#### 10. 遍历理论：
+ 遍历性：
	- 均值遍历：随机相位正弦波是均值遍历
	- 自相关遍历

* * *

## 二阶矩过程-频域分析

#### 11. 确定性信号的谱分析

+ 周期函数的傅里叶级数：
	- 要求(狄利克雷条件)：
		* 绝对可积
		* 间断点数目有限
		* 周期内极大值与极小值数目有限
+ 周期函数的傅里叶级数和非周期函数的傅里叶变换具有内在的一致性，可以统一表示为stieljes积分
+ Parseval不等式

#### 12. 宽平稳过程的相关函数的谱分析
+ 谱密度与自相关函数R(τ)互为傅里叶变换
+ 谱密度也称功率谱密度
	- 功率谱密度只包含信号的幅度谱，相位谱的信息完全丢失
+ 功率谱估计：
	- 周期图谱估计法：周期图是功率谱密度的渐近无偏估计
+ 联合平稳过程的互相关函数和互谱密度
	- 连续情形：傅里叶变换
	- 离散情形：DTFT

#### 13. 随机过程通过线性系统

+ 宽平稳随机过程通过线性时不变系统会输出宽平稳随机
过程，输入过程与输出过程是联合宽平稳的
+ 平稳随机序列经过离散时间线性时不变系统后仍然是平稳的

#### 14. 谱分解定理和采样定理
+ 谱分解定理：
	- 一个零均值的均方连续的平稳随机过程，可以看做许多元谐波震荡的叠加，这些震荡覆盖了整个频率轴上，它的复振幅为随机的，复振幅的均值为零，不同频率的复振幅是不相关的
+ 采样定理：
	- Nyquist采样定理：对于确定性信号，如果其能量谱限制在(-B;B)之间(带限信号)，则以不低于2B的采样频率对信号进行等间隔采样得到采样序列，原信号可以完全被确定

* * *

## 高斯过程

#### 15. 高斯过程基本定义
+ 连续参数、连续状态
+ 高斯过程：任意时刻对应的随机变量的联合分布为多元高斯分布
+ 多元高斯分布：
	- 性质：
		* 联合分布函数非负
		* 协方差矩阵是正定阵
		* 随机变量的独立性可以通过特征函数来刻画
			+ Σ不满秩时，pdf无法写出，但是可以写出特征函数
	- 边缘分布：n元高斯分布的任何一个子向量服从高斯分布
	- 独立性：两个随机变量独立的充要条件是协方差矩阵的对应位置元素为0
	- 线性变换不变性质：
		* 若Z ~ N(μ,Σ)，Y = AZ + b，则Y ~ N(Aμ+b, AΣA^T)
	- 条件分布：

	![image](https://raw.githubusercontent.com/charlesliucn/summer-review/master/12-%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/figures/01.png?token=AYGNCBkwpAnwqe9iCn4ezEOdxlROI1cNks5Zr-PrwA%3D%3D)

+ 高斯马尔可夫性：
	- 随机过程既是实高斯过程，又是马尔可夫过程

#### 16. PCA简介
+ PCA在数据降维问题上得到了极为广泛的应用
+ 第一主成分方向就是方差最大，X投影其上变化最大的方向
+ 第二第三等主成分方向类比即可

#### 17. 实高斯过程
+ 实高斯过程：**严平稳和宽平稳是等价的**
+ 高斯过程，**独立和不相关是等价的**
+ 高斯矢量序列的均方极限服从高斯分布
+ **均方收敛一定依概率收敛**；依概率收敛不一定均方收敛
+ 若高斯过程均方可导(均方可积)，则求导(积分)后的随机过程也是高斯过程
+ 高斯过程通过线性系统后，输出过程也是高斯过程，联合起来也是高斯过程

#### 18. 窄带高斯过程
+ Rayleigh分布和Rician分布是高斯分布常见的两类衍生分布
+ 什么是窄带高斯过程
	- 包络过程
	- 相位过程
+ 零均值窄带高斯过程
+ 均值不为0的窄带高斯过程 = 正弦波随机相位过程 + 零均值窄带高斯过程


* * * 

## 泊松过程

#### 19. 泊松过程基本概念

+ 泊松过程是一类计数过程
+ 泊松过程：参数连续、状态空间离散，并且具有马氏性
+ 计数过程：
	- 基本性质：
		* 非负性
		* 整数
		* 单调不减
	- **平稳计数过程**：在某一时间间隔内的计数只与时间差有关，与时间差无关
+ 独立增量过程：
	- 随机过程X(t)的增量之间相互独立，称为独立增量过程
	- 当X(0)=0时，独立增量过程是马氏过程
	- 独立增量计数过程：**计数过程**中在不相交的时间间隔内事件出现的次数是**相互独立**的
+ 齐次泊松过程：
	- 一些条件：
		1. 计数过程
		2. N(0)=0
		3. 独立增量性
		4. **增量平稳性**
		5. 泊松分布特性
		6. ![image](https://raw.githubusercontent.com/charlesliucn/summer-review/master/12-%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/figures/02.png?token=AYGNCLwtJD-SQL91-P59AX5bz0eimOyjks5Zr-PtwA%3D%3D)
		
	- 齐次泊松过程的定义：
		* 定义1：1 + 2 + 3 + 4 + 5
		* 定义2：1 + 2 + 3 + 6
	- 条件6是泊松过程的本质性质，体现了泊松过程的稀疏性
+ 泊松过程举例：
	- 汽车按强度为λ的泊松过程发车
	- 顾客按强度为λ的泊松过程到达
	- 总机按强度为λ的泊松过程收到呼叫


#### 20. 泊松过程的性质
+ 非宽平稳性：
	- 均值函数为E[N(t)] = λt，与时间t有关
	- 相关函数不能表示为时间差的函数
	- 由于以上两个条件，泊松过程是非平稳随机过程
+ 事件间隔时间的分布：
	- 计数过程是强度为λ的其次泊松过程 ←→ 事件的间隔是独立同分布的参数为λ的指数分布
+ 顺序统计量：

![image](https://raw.githubusercontent.com/charlesliucn/summer-review/master/12-%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/figures/03.png?token=AYGNCI1qVvoFpEcmBWJsIMUDlQTYWrMZks5Zr-PzwA%3D%3D)

+ 乘客按照参数为λ的泊松过程来到公交站，公交车时刻t出发。
求：[0,t]内到达车站的乘客的等待时间之和的期望？

![image](https://raw.githubusercontent.com/charlesliucn/summer-review/master/12-%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/figures/04.png?token=AYGNCBie9iyCAvjTQqYYcWaWar_CVzmeks5Zr-P1wA%3D%3D)

+ 年龄与寿命问题
	- 年龄：泊松过程中当前状态的已持续时间
	- 寿命：泊松过程中当前状态将持续多长时间
	- 年龄服从指数分布
	- 泊松过程具有马氏性→年龄与寿命两个随机过程是统计独立的
	- 一个年龄为t的零件，它剩余寿命的分布同一个新零件是一样的。

#### 21. 非齐次泊松过程
+ 非齐次泊松过程的要求：
	- N(0) = 0
	- 独立增量过程
	- 泊松分布特性或者下方的公式约束：

	![image](https://raw.githubusercontent.com/charlesliucn/summer-review/master/12-%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/figures/05.png?token=AYGNCNqBH6p0MrLdAKIRRTx8sltC8MNCks5Zr-P2wA%3D%3D)

+ 速率函数λ(t)的非齐次泊松过程
	- λ(t) = λ时，退化为标准泊松过程

#### 22. 复合泊松过程
+ 复合泊松过程
+ 泊松过程的和过程：也是泊松过程，强度为各子过程的强度之和
+ 泊松过程的分流：男女顾客分开
+ 泊松过程之差